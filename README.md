# âš¡ çªƒç”µæ£€æµ‹å¤šæ¨¡æ€å¤§æ¨¡å‹ (AXISé£æ ¼)

<p align="center">
  <img src="https://img.shields.io/badge/PyTorch-2.0+-ee4c2c?style=flat&logo=pytorch" alt="PyTorch">
  <img src="https://img.shields.io/badge/LLM-Qwen3-1.7B-blue" alt="Qwen3">
  <img src="https://img.shields.io/badge/License-Internal-green" alt="License">
</p>

> åŸºäºAXISæ¶æ„çš„ç«¯åˆ°ç«¯çªƒç”µæ£€æµ‹ç³»ç»Ÿï¼Œç»“åˆæ—¶é—´åºåˆ—ç¼–ç å™¨å’Œå¤§è¯­è¨€æ¨¡å‹(LLM)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1ï¸âƒ£ ç¯å¢ƒå‡†å¤‡

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/wth1998/electricity-theft-detection.git
cd electricity-theft-detection

# å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 2ï¸âƒ£ æ•°æ®å‡†å¤‡

```
dataset/
â”œâ”€â”€ File1_train.csv               # æ— æ ‡ç­¾è®­ç»ƒæ•°æ®ï¼ˆç”¨äºé¢„è®­ç»ƒï¼‰
â”œâ”€â”€ File1_test_daily_flag_4_1.csv # å¸¦æ ‡ç­¾è®­ç»ƒæ•°æ®ï¼ˆç”¨äºå¾®è°ƒï¼‰
â””â”€â”€ user_historical_stats.json    # ç”¨æˆ·å†å²ç»Ÿè®¡
```

### 3ï¸âƒ£ è®­ç»ƒæµç¨‹

#### ğŸ“š é˜¶æ®µ1: é¢„è®­ç»ƒï¼ˆè‡ªç›‘ç£ï¼‰

```bash
python scripts/train_pretrain_axis.py \
    --config MEDIUM \
    --epochs 50 \
    --batch-size 16 \
    --seed 42
```

| å‚æ•° | è¯´æ˜ | é»˜è®¤å€¼ |
|------|------|--------|
| `--config` | æ¨¡å‹é…ç½® [SMALL/BASE/MEDIUM/LARGE] | MEDIUM |
| `--use-first-n` | ä½¿ç”¨æ ·æœ¬æ•° | 5000 |
| `--seed` | éšæœºç§å­ | 42 |

#### ğŸ¯ é˜¶æ®µ2: å¾®è°ƒï¼ˆç›‘ç£å­¦ä¹ ï¼‰

```bash
python scripts/train_finetune_axis.py \
    --config MEDIUM \
    --epochs 20 \
    --pretrain-ckpt checkpoints_pretrain_axis/pretrain_medium_best.pth \
    --seed 42 \
    --batch-size 4 \
    --lr 2e-4
```

| å‚æ•° | è¯´æ˜ | æ¨èå€¼ |
|------|------|--------|
| `--pretrain-ckpt` | é¢„è®­ç»ƒæƒé‡è·¯å¾„ | auto |
| `--batch-size` | æ‰¹æ¬¡å¤§å° | 4 (2x3090) |
| `--lr` | å­¦ä¹ ç‡ | 2e-4 |
| `--seed` | éšæœºç§å­ | 42 |

#### âš¡ é«˜çº§å‚æ•°

```bash
# ç¦ç”¨åŠ æƒé‡‡æ ·
--no-weighted-sampler

# å¿«é€Ÿæµ‹è¯•ï¼ˆ1000æ ·æœ¬ï¼Œ5è½®ï¼‰
--quick

# å¯ç”¨è°ƒè¯•æ¨¡å¼
--debug

# å†»ç»“ç¼–ç å™¨
--freeze-encoder
```

#### ğŸ§ª é˜¶æ®µ3: æµ‹è¯•

```bash
python scripts/test_axis_improved.py \
    --config MEDIUM \
    --checkpoint checkpoints_finetune_axis/finetune_medium_best.pth \
    --debug
```

---

## ğŸ—ï¸ æ¨¡å‹æ¶æ„è¯¦è§£

### ä¸‰å¤§ç»„ä»¶

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           è¾“å…¥ï¼šç”¨æˆ·æ—¥ç”¨ç”µæ•°æ® (48ä¸ªæ—¶é—´ç‚¹)              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  1ï¸âƒ£ æ—¶é—´åºåˆ—ç¼–ç å™¨ (TS Encoder) - å¯å­¦ä¹                                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ â€¢ PatchåŒ–ï¼šå°†48ç‚¹ â†’ 8ä¸ªpatchï¼ˆæ¯patch 6ç‚¹ï¼‰                         â”‚â”‚
â”‚  â”‚ â€¢ RoPEï¼šæ—‹è½¬ä½ç½®ç¼–ç ï¼Œç†è§£æ—¶é—´é¡ºåº                                   â”‚â”‚
â”‚  â”‚ â€¢ Transformerè‡ªæ³¨æ„åŠ›ï¼šå­¦ä¹ patché—´å…³ç³»                              â”‚â”‚
â”‚  â”‚ â€¢ LlamaMLPï¼šå¢å¼ºç‰¹å¾è¡¨è¾¾                                            â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚  è¾“å…¥: (B, 48, 1)  â†’  è¾“å‡º: (B, 8, 1, 256)                             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  2ï¸âƒ£ Perceiverèåˆå±‚ - å¯å­¦ä¹                                             â”‚
â”‚  å°†æ—¶é—´åºåˆ—ç‰¹å¾æ˜ å°„åˆ°LLMçš„è¯åµŒå…¥ç©ºé—´                                     â”‚
â”‚  è¾“å…¥: (B, 8, 1, 256) + LLMè¯åµŒå…¥  â†’  è¾“å‡º: Soft Prompts (B, N, D)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  3ï¸âƒ£ å¤§è¯­è¨€æ¨¡å‹ (LLM) - å†»ç»“                                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€ â”‚
â”‚ â”€â”â”‚
â”‚  â”‚ è¾“å…¥: [Soft Prompts | æ–‡æœ¬æŒ‡ä»¤]                                     â”‚â”‚
â”‚  â”‚ è¾“å‡º: Theft / Normal åˆ†ç±»                                           â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é¢„è®­ç»ƒ vs å¾®è°ƒ

| é˜¶æ®µ | æ•°æ® | ä»»åŠ¡ | è®­ç»ƒç›®æ ‡ | å¿…è¦æ€§ |
|------|------|------|----------|--------|
| **é¢„è®­ç»ƒ** | æ— æ ‡ç­¾ | æ©ç é‡å»º + å¼‚å¸¸æ£€æµ‹ | è®©ç¼–ç å™¨å­¦åˆ°ç”µåŠ›è´Ÿè·çš„æ­£å¸¸/å¼‚å¸¸æ¨¡å¼ | æ¨èä½†å¯é€‰ |
| **å¾®è°ƒ** | å¸¦æ ‡ç­¾ | ç«¯åˆ°ç«¯åˆ†ç±» | è®©æ„ŸçŸ¥å±‚é€‚é…LLMçš„è¯­ä¹‰ç©ºé—´ | å¿…é¡» |

#### é¢„è®­ç»ƒä»»åŠ¡è¯¦è§£

| ä»»åŠ¡ | è¾“å…¥ | ç›®æ ‡ | æ„ä¹‰ |
|------|------|------|------|
| **æ©ç é‡å»º** | éšæœºé®æŒ¡15%çš„patch | é¢„æµ‹åŸå§‹ç”¨ç”µå€¼ | å­¦åˆ°æ­£å¸¸ç”¨ç”µæ¨¡å¼ |
| **å¼‚å¸¸æ£€æµ‹** | å®Œæ•´patch | äºŒåˆ†ç±»ï¼ˆæ­£å¸¸/å¼‚å¸¸ï¼‰ | å­¦åˆ°å¼‚å¸¸æ¨¡å¼ç‰¹å¾ |

#### ä¸ºä»€ä¹ˆéœ€è¦é¢„è®­ç»ƒï¼Ÿ

1. **ä»é›¶å¼€å§‹ vs é¢„è®­ç»ƒ**ï¼šç¼–ç å™¨å‚æ•°éšæœºåˆå§‹åŒ– vs å­¦åˆ°ç”µåŠ›è´Ÿè·æ¨¡å¼
2. **æ”¶æ•›é€Ÿåº¦**ï¼šé¢„è®­ç»ƒåæ”¶æ•›æ›´å¿«
3. **æ•ˆæœæå‡**ï¼šé€šå¸¸æå‡10-15%æ€§èƒ½

> ä¸NLPä¸­BERT/LLMçš„é¢„è®­ç»ƒ-å¾®è°ƒèŒƒå¼ç›¸åŒï¼šå…ˆåœ¨å¤§è§„æ¨¡æ— æ ‡ç­¾æ•°æ®ä¸Šå­¦é€šç”¨çŸ¥è¯†ï¼Œå†åœ¨ä¸‹æ¸¸ä»»åŠ¡ä¸Šç²¾è°ƒ

#### å¾®è°ƒç»†èŠ‚

- **å†»ç»“LLM**ï¼šä¸è®­ç»ƒå¤§æ¨¡å‹æœ¬èº«ï¼ˆåªè®­ç»ƒæ„ŸçŸ¥å±‚ï¼‰
- **å­¦ä¹ å†…å®¹**ï¼šå¦‚ä½•å°†æ•°å€¼ç‰¹å¾æ˜ å°„åˆ°LLMçš„è¯­ä¹‰ç©ºé—´
- **LLMä½œç”¨**ï¼šä½œä¸º"æ¨ç†å¼•æ“"ï¼Œç»“åˆæ•°å€¼ç‰¹å¾å’Œæ–‡æœ¬çŸ¥è¯†åšåˆ¤æ–­

---

## ğŸ› ä¿®å¤çš„å…³é”®Bug

### âœ… 1. Labelå¯¹é½é€»è¾‘ï¼ˆè®­ç»ƒæœ‰æ•ˆæ€§ï¼‰
- **é—®é¢˜**: labelæ„å»ºé”™è¯¯å¯¼è‡´æ¨¡å‹æ— æ³•å­¦ä¹ 
- **ä¿®å¤**: é‡æ„`forward`å‡½æ•°ï¼Œæ­£ç¡®å¯¹é½soft promptå’Œlabel

### âœ… 2. éšæœºç§å­è®¾ç½®ï¼ˆå¯å¤ç°æ€§ï¼‰
- **é—®é¢˜**: è®­ç»ƒç»“æœæ¯æ¬¡è¿è¡Œéƒ½ä¸åŒ
- **ä¿®å¤**: å®Œæ•´è®¾ç½®æ‰€æœ‰éšæœºç§å­ï¼ˆåŒ…æ‹¬CUDAã€DataLoader workerï¼‰

### âœ… 3. é¢„è®­ç»ƒä¼ªæ ‡ç­¾ï¼ˆæ•°æ®è´¨é‡ï¼‰
- **é—®é¢˜**: ä½¿ç”¨å½“æ—¥ç»Ÿè®¡ç”Ÿæˆä¼ªæ ‡ç­¾ï¼Œè´¨é‡å·®
- **ä¿®å¤**: ä½¿ç”¨ç”¨æˆ·å†å²ç»Ÿè®¡é‡ç”Ÿæˆä¼ªæ ‡ç­¾

### âœ… 4. ç±»åˆ«ä¸å¹³è¡¡ï¼ˆ1:9ï¼‰
- **é—®é¢˜**: çªƒç”µæ ·æœ¬å°‘ï¼Œæ¨¡å‹å€¾å‘é¢„æµ‹"æ­£å¸¸"
- **ä¿®å¤**: 
  - WeightedRandomSamplerè¿‡é‡‡æ ·
  - Focal Lossæ”¯æŒ

---

## âš¡ æ€§èƒ½ä¼˜åŒ–

### ğŸ¯ 1. åˆ†å±‚å­¦ä¹ ç‡
```
ç¼–ç å™¨: 0.1 Ã— lr  (è¾ƒå°ï¼Œé˜²æ­¢ç ´åé¢„è®­ç»ƒç‰¹å¾)
èåˆå±‚: 1.0 Ã— lr  (æ ‡å‡†å­¦ä¹ ç‡)
```

### ğŸ“ 2. ç²¾ç®€æ–‡æœ¬æç¤º
```
ä» ~150 tokens å‡å°‘åˆ° ~50 tokens
ä¿ç•™å…³é”®æŒ‡æ ‡ï¼šç”¨ç”µé‡ã€é›¶å€¼æ¯”ä¾‹ã€ç¨³å®šæ¨¡å¼ã€å¼‚å¸¸æ•°ã€é£é™©ä¿¡å·
```

### ğŸ“Š 3. éªŒè¯é›†æŒ‡æ ‡ç›‘æ§
- AUCã€MAP@40ã€WF1ã€F1_Theft
- ç»¼åˆè¯„åˆ†ç”¨äºæ—©åœ (AUC 30% + MAP@40 30% + WF1 20% + F1_Theft 20%)

### ğŸ“ˆ 4. TensorBoardæ”¯æŒ
```bash
# å¯åŠ¨TensorBoard
tensorboard --logdir runs/ --port 6006
```

---

## ğŸ’» æ¨¡å‹é…ç½®

| é…ç½® | d_model | d_proj | Layers | Heads | å‚æ•°é‡ | åœºæ™¯ |
|------|---------|--------|--------|-------|--------|------|
| ğŸŸ¢ SMALL | 256 | 128 | 4 | 4 | ~2M | å¿«é€Ÿå®éªŒ |
| ğŸ”µ BASE | 512 | 256 | 6 | 8 | ~8M | æ ‡å‡†è®­ç»ƒ |
| ğŸŸ£ **MEDIUM** | **512** | **256** | **8** | **8** | **~12M** | **æ¨è** |
| ğŸŸ  LARGE | 768 | 384 | 10 | 12 | ~25M | é«˜ç²¾åº¦ |

> ğŸ’¡ **MEDIUMé…ç½®æ¨èç”¨äº 2Ã—3090ï¼ˆ48GBæ˜¾å­˜ï¼‰**

---

## ğŸ–¥ï¸ ç¡¬ä»¶è¦æ±‚

| çº§åˆ« | é…ç½® |
|------|------|
| ğŸŸ¡ æœ€ä½ | 1Ã— GPU 16GB VRAM |
| ğŸŸ¢ æ¨è | 2Ã— GPU 48GB VRAM (2Ã— RTX 3090) |
| ğŸ’¾ å†…å­˜ | 32GB+ RAM |
| ğŸ’¿ å­˜å‚¨ | 10GB+ for checkpoints |

---

## ğŸ“Š é¢„æœŸæ€§èƒ½

| æŒ‡æ ‡ | ä¿®å¤å‰ | ä¿®å¤åï¼ˆç›®æ ‡ï¼‰ | æå‡ |
|------|--------|---------------|------|
| AUC | ~0.65 | ğŸŸ¢ **~0.85+** | +30% |
| MAP@40 | ~0.20 | ğŸŸ¢ **~0.50+** | +150% |
| WF1 | ~0.60 | ğŸŸ¢ **~0.80+** | +33% |
| çªƒç”µå¬å›ç‡ | ~50% | ğŸŸ¢ **~80%+** | +60% |

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
.
â”œâ”€â”€ ğŸ“¦ models/                      # æ ¸å¿ƒæ¨¡å‹
â”‚   â”œâ”€â”€ ts_encoder_axis.py        # æ—¶é—´åºåˆ—ç¼–ç å™¨
â”‚   â”œâ”€â”€ perceiver_fusion.py       # èåˆæ¨¡å—
â”‚   â”œâ”€â”€ main_axis_improved.py     # ä¸»æ¨¡å‹å’Œæ•°æ®é›†
â”‚   â””â”€â”€ agent_axis.py             # Agentï¼ˆå«LLMï¼‰
â”‚
â”œâ”€â”€ ğŸ“œ scripts/                    # è®­ç»ƒè„šæœ¬
â”‚   â”œâ”€â”€ train_pretrain_axis.py    # é¢„è®­ç»ƒ
â”‚   â”œâ”€â”€ train_finetune_axis.py    # å¾®è°ƒ
â”‚   â””â”€â”€ test_axis_improved.py     # æµ‹è¯•
â”‚
â”œâ”€â”€ ğŸ”§ utils/                      # å·¥å…·
â”‚   â”œâ”€â”€ metrics.py                # è¯„ä¼°æŒ‡æ ‡
â”‚   â”œâ”€â”€ losses.py                 # Focal Lossç­‰
â”‚   â”œâ”€â”€ seed_utils.py             # éšæœºç§å­è®¾ç½®
â”‚   â””â”€â”€ visualization.py          # å¯è§†åŒ–
â”‚
â”œâ”€â”€ ğŸ§© layers/                    # åŸºç¡€å±‚
â”‚   â”œâ”€â”€ axis_RoPE.py              # RoPEä½ç½®ç¼–ç 
â”‚   â””â”€â”€ RevIN.py                  # å¯é€†å®ä¾‹å½’ä¸€åŒ–
â”‚
â”œâ”€â”€ ğŸ“– AGENTS.md                   # è¯¦ç»†æ¶æ„è¯´æ˜
â””â”€â”€ ğŸ“‹ README.md                   # é¡¹ç›®è¯´æ˜
```

---

## ğŸ’¡ è®­ç»ƒæŠ€å·§

### 1ï¸âƒ£ å¿«é€ŸéªŒè¯ä¿®å¤æ˜¯å¦æœ‰æ•ˆ
```bash
# ä½¿ç”¨å¿«é€Ÿæ¨¡å¼ï¼ˆ1000æ ·æœ¬ï¼Œ5è½®ï¼‰
python scripts/train_finetune_axis.py --quick --config SMALL

# è§‚å¯Ÿï¼š
# âœ“ Lossæ˜¯å¦ä¸‹é™
# âœ“ ç»“æœæ˜¯å¦å¯å¤ç°ï¼ˆç›¸åŒseedï¼‰
```

### 2ï¸âƒ£ ç›‘æ§è®­ç»ƒè¿‡ç¨‹
```bash
# ç»ˆç«¯1: å¯åŠ¨TensorBoard
tensorboard --logdir runs/ --port 6006

# ç»ˆç«¯2: è®­ç»ƒ
python scripts/train_finetune_axis.py --config MEDIUM

# æµè§ˆå™¨æ‰“å¼€ http://localhost:6006
```

### 3ï¸âƒ£ å¤„ç†è®­ç»ƒä¸ç¨³å®š
```bash
# é™ä½å­¦ä¹ ç‡
--lr 1e-4

# å¢å¤§æ‰¹æ¬¡å¤§å°
--batch-size 8

# ä½¿ç”¨æ›´å°æ¨¡å‹
--config SMALL
```

### 4ï¸âƒ£ å¤„ç†è¿‡æ‹Ÿåˆ
```bash
# å†»ç»“ç¼–ç å™¨
--freeze-encoder

# å‡å°‘è®­ç»ƒè½®æ•°
--epochs 10
```

---

## â“ å¸¸è§é—®é¢˜

**Q: ä¸€å®šè¦é¢„è®­ç»ƒå—ï¼Ÿ**
> A: ä¸æ˜¯å¿…é¡»çš„ï¼Œä½†æ¨èã€‚é¢„è®­ç»ƒå¯æå‡10-15%æ€§èƒ½ï¼ŒåŠ å¿«æ”¶æ•›ã€‚ä¹Ÿå¯ç›´æ¥è¿›è¡Œå¾®è°ƒã€‚

**Q: æŸå¤±ä¸ä¸‹é™ï¼Ÿ**
> A: æ£€æŸ¥ï¼š1) Labelæ˜¯å¦æ­£ç¡®å¯¹é½ 2) éšæœºç§å­æ˜¯å¦è®¾ç½® 3) å­¦ä¹ ç‡æ˜¯å¦è¿‡é«˜

**Q: æ˜¾å­˜ä¸è¶³ï¼Ÿ**
> A: ä½¿ç”¨ `--config SMALL`ï¼Œæˆ–å‡å° `--batch-size`ï¼Œæˆ–å¯ç”¨ `load_in_4bit=True`

**Q: ç»“æœä¸ç¨³å®šï¼Ÿ**
> A: ç¡®ä¿ä½¿ç”¨ç›¸åŒçš„ `--seed`

**Q: çªƒç”µå¬å›ç‡ä½ï¼Ÿ**
> A: å°è¯•ï¼š1) é™ä½é˜ˆå€¼ 2) å¢åŠ è®­ç»ƒè½®æ•° 3) ä½¿ç”¨Focal Loss

---

## ğŸ“œ å¼•ç”¨

```bibtex
@software{electricity_theft_detection,
  title={Electricity Theft Detection with AXIS and LLM},
  author={Your Name},
  year={2025},
  url={https://github.com/wth1998/electricity-theft-detection}
}
```

---

## ğŸ“ è®¸å¯

å†…éƒ¨ä½¿ç”¨

---

<p align="center">
  <strong>æœ€åæ›´æ–°</strong>: 2026å¹´2æœˆ  |  <strong>ç‰ˆæœ¬</strong>: v2.1 (æ¶æ„è¯´æ˜ç‰ˆ)
</p>
